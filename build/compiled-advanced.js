(function(){var f=null,h=!1,i=this;
function aa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function j(a){return void 0!==a}function k(a){return"string"==typeof a}function l(a,b){var c=a.split("."),e=i;!(c[0]in e)&&e.execScript&&e.execScript("var "+c[0]);for(var d;c.length&&(d=c.shift());)!c.length&&j(b)?e[d]=b:e=e[d]?e[d]:e[d]={}}function m(a,b){function c(){}c.prototype=b.prototype;a.L=b.prototype;a.prototype=new c};function n(a,b){for(var c in a)if(a[c]==b)return!0;return h};var o={};l("sb.NodeType",o);o.UnspecifiedEntity="unspecified entity";o.SimpleChemical="simple chemical";o.Macromolecule="macromolecule";o.NucleicAcidFeature="nucleic acid feature";o.SimpleChemicalMultimer="simple chemical multimer";o.MacromoleculeMultimer="macromolecule multimer";o.NucleicAcidFeatureMultimer="nucleic acid feature multimer";o.Complex="complex";o.ComplexMultimer="complex multimer";o.SourceAndSink="source and sink";o.Perturbation="perturbation";o.BiologicalActivity="biological activity";
o.PerturbingAgent="perturbing agent";o.Compartment="compartment";o.Submap="submap";o.Tag="tag";o.Terminal="terminal";o.Process="process";o.OmittedProcess="omitted process";o.UncertainProcess="uncertain process";o.Association="association";o.Dissociation="dissociation";o.Phenotype="phenotype";o.And="and";o.Or="or";o.Not="not";o.StateVariable="state variable";o.UnitOfInformation="unit of information";o.Stoichiometry="stoichiometry";o.Entity="entity";o.Outcome="outcome";o.Observable="observable";
o.Interaction="interaction";o.InfluenceTarget="influence target";o.Annotation="annotation";o.VariableValue="variable value";o.ImplicitXor="implicit xor";o.Delay="delay";o.Existence="existence";o.Location="location";o.Cardinality="cardinality";function ba(a){return n(o,a)}l("sb.NodeTypeHelper.isNodeTypeSupported",ba);function ca(a){for(var b=0,c=(""+p).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),a=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,a.length),d=0;0==b&&d<e;d++){var g=c[d]||"",J=a[d]||"",x=RegExp("(\\d*)(\\D*)","g"),K=RegExp("(\\d*)(\\D*)","g");do{var s=x.exec(g)||["","",""],t=K.exec(J)||["","",""];if(0==s[0].length&&0==t[0].length)break;b=((0==s[1].length?0:parseInt(s[1],10))<(0==t[1].length?0:parseInt(t[1],10))?-1:(0==s[1].length?0:parseInt(s[1],10))>(0==t[1].length?
0:parseInt(t[1],10))?1:0)||((0==s[2].length)<(0==t[2].length)?-1:(0==s[2].length)>(0==t[2].length)?1:0)||(s[2]<t[2]?-1:s[2]>t[2]?1:0)}while(0==b)}return b};var q=Array.prototype,da=q.indexOf?function(a,b,c){return q.indexOf.call(a,b,c)}:function(a,b,c){c=c==f?0:0>c?Math.max(0,a.length+c):c;if(k(a))return!k(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},r=q.forEach?function(a,b,c){q.forEach.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=k(a)?a.split(""):a,g=0;g<e;g++)g in d&&b.call(c,d[g],g,a)},ea=q.filter?function(a,b,c){return q.filter.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=[],g=0,J=k(a)?a.split(""):
a,x=0;x<e;x++)if(x in J){var K=J[x];b.call(c,K,x,a)&&(d[g++]=K)}return d};function fa(a,b){return 0<=da(a,b)}function u(a,b){fa(a,b)||a.push(b)};function v(a,b){this.e={};this.c=[];var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var e=0;e<c;e+=2)this.set(arguments[e],arguments[e+1])}else if(a){var d;if(a instanceof v){w(a);e=a.c.concat();w(a);d=[];for(c=0;c<a.c.length;c++)d.push(a.e[a.c[c]])}else{var c=[],g=0;for(e in a)c[g++]=e;e=c;c=[];g=0;for(d in a)c[g++]=a[d];d=c}for(c=0;c<e.length;c++)this.set(e[c],d[c])}}v.prototype.i=0;
v.prototype.remove=function(a){return Object.prototype.hasOwnProperty.call(this.e,a)?(delete this.e[a],this.i--,this.c.length>2*this.i&&w(this),!0):h};function w(a){if(a.i!=a.c.length){for(var b=0,c=0;b<a.c.length;){var e=a.c[b];Object.prototype.hasOwnProperty.call(a.e,e)&&(a.c[c++]=e);b++}a.c.length=c}if(a.i!=a.c.length){for(var d={},c=b=0;b<a.c.length;)e=a.c[b],Object.prototype.hasOwnProperty.call(d,e)||(a.c[c++]=e,d[e]=1),b++;a.c.length=c}}
v.prototype.get=function(a,b){return Object.prototype.hasOwnProperty.call(this.e,a)?this.e[a]:b};v.prototype.set=function(a,b){Object.prototype.hasOwnProperty.call(this.e,a)||(this.i++,this.c.push(a));this.e[a]=b};v.prototype.n=function(){return new v(this)};function y(){this.h=new v}l("sb.model.AttributeObject",y);y.prototype.a=function(a,b,c){if(j(b)){var e=this.h.get(a);this.h.set(a,b);c&&"id"==a&&(e&&c.r.remove(e),c.r.set(b,this));return this}return this.h.get(a)};y.prototype.attr=y.prototype.a;function z(a){this.h=new v;this.b=a;this.m=[];this.parent=f}m(z,y);l("sb.model.Element",z);z.prototype.id=function(a){if(j(a)){var b=this.b.element(a);if(b&&b!=this)throw Error("Given element id "+a+" already existed");}return this.a("id",a,this.b)};z.prototype.id=z.prototype.id;z.prototype.g=function(a){a.parent&&a.parent.removeChild(a);u(this.m,a);a.parent=this};z.prototype.addChild=z.prototype.g;z.prototype.removeChild=function(a){var b=this.m,c=da(b,a);0<=c&&q.splice.call(b,c,1);a.parent=f};
z.prototype.removeChild=z.prototype.removeChild;z.prototype.children=function(){return this.m};z.prototype.children=z.prototype.children;function A(a){z.call(this,a)}m(A,z);l("sb.Port",A);function B(a){z.call(this,a)}m(B,z);l("sb.Node",B);B.prototype.type=function(a){if(j(a)&&!ba(a))throw Error("Given node type "+a+" is not supported.");return this.a("type",a)};B.prototype.type=B.prototype.type;B.prototype.label=function(a){return this.a("label",a)};B.prototype.label=B.prototype.label;B.prototype.n=function(a){return this.a("clone",a)};B.prototype.clone=B.prototype.n;B.prototype.t=function(a){a=this.b.createNode(a);this.g(a);return a};B.prototype.createSubNode=B.prototype.t;
B.prototype.d=function(a){a=this.b.d(a);this.g(a);return a};B.prototype.createPort=B.prototype.d;var C={};l("sb.ArcType",C);C.Production="production";C.Consumption="consumption";C.Catalysis="catalysis";C.Modulation="modulation";C.Stimulation="stimulation";C.Inhibition="inhibition";C.Assignment="assignment";C.Interaction="interaction";C.AbsoluteInhibition="absolute inhibition";C.AbsoluteStimulation="absolute stimulation";C.PositiveInfluence="positive influence";C.NegativeInfluence="negative influence";C.UnknownInfluence="unknown influence";C.EquivalenceArc="equivalence arc";
C.NecessaryStimulation="necessary stimulation";C.LogicArc="logic arc";function ga(a){return n(C,a)}l("sb.ArcTypeHelper.isArcTypeSupported",ga);function D(a){z.call(this,a)}m(D,z);l("sb.Arc",D);D.prototype.type=function(a){if(j(a)&&!ga(a))throw Error("Given arc type "+a+" is not supported.");return this.a("type",a)};D.prototype.type=D.prototype.type;D.prototype.source=function(a){if(a&&k(a)){var b=this.b.element(a);if(!b)throw Error("Element "+a+" do not exist.");a=b}return this.a("source",a)};D.prototype.source=D.prototype.source;
D.prototype.target=function(a){if(a&&k(a)){var b=this.b.element(a);if(!b)throw Error("Element "+a+" do not exist.");a=b}return this.a("target",a)};D.prototype.target=D.prototype.target;D.prototype.d=function(a){a=this.b.d(a);this.g(a);return a};D.prototype.createPort=D.prototype.d;function E(a){this.h=new v;this.id=a;this.H=this.z=this.G=1;this.r=new v;this.s=[];this.l=[]}m(E,y);l("sb.Document",E);E.prototype.createNode=function(a){a=a?a:ha(this);a=(new B(this)).id(a);u(this.s,a);return a};E.prototype.createNode=E.prototype.createNode;function ha(a){var b="node"+a.G++;return a.element(b)?ha(a):b}E.prototype.u=function(a){return a?ea(this.s,function(a){return a.parent?h:!0}):this.s};E.prototype.nodes=E.prototype.u;
E.prototype.F=function(a){a=this.element(a);return a instanceof B?a:f};E.prototype.node=E.prototype.F;E.prototype.element=function(a){return this.r.get(a)};E.prototype.p=function(a){a=a?a:ia(this);a=(new D(this)).id(a);u(this.l,a);return a};E.prototype.createArc=E.prototype.p;E.prototype.C=function(a,b){var c=this.p();c.source(a).target(b);return c};E.prototype.connect=E.prototype.C;function ia(a){var b="arc"+a.z++;return a.element(b)?ia(a):b}E.prototype.A=function(){return this.l};
E.prototype.arcs=E.prototype.A;E.prototype.arc=function(a){a=this.element(a);return a instanceof D?a:f};E.prototype.arc=E.prototype.arc;function ja(a){var b="port"+a.H++;return a.element(b)?ja(a):b}E.prototype.d=function(a){a=a?a:ja(this);return(new A(this)).id(a)};E.prototype.createPort=E.prototype.d;E.prototype.lang=function(a){if(j(a)&&!n(ka,a))throw Error("Given SBGN language type "+a+" is not supported.");return this.a("language",a)};var ka={I:"activity flow",J:"entity relationship",K:"process description"};
l("sb.Language",ka);function la(a,b){this.x=j(a)?a:0;this.y=j(b)?b:0}l("sb.Point",la);function F(a,b,c,e){this.x=j(a)?a:0;this.y=j(b)?b:0;this.width=j(c)?c:0;this.height=j(e)?e:0}l("sb.Box",F);F.prototype.contains=function(a){return a.x>=this.x&&a.y>=this.y&&this.x+this.width>=a.x+a.width&&this.y+this.height>=a.y+a.height};var G,H,I,L;function ma(){return i.navigator?i.navigator.userAgent:f}L=I=H=G=h;var M;if(M=ma()){var na=i.navigator;G=0==M.indexOf("Opera");H=!G&&-1!=M.indexOf("MSIE");I=!G&&-1!=M.indexOf("WebKit");L=!G&&!I&&"Gecko"==na.product}var N=H,O=L,oa=I,p;
a:{var P="",Q;if(G&&i.opera)var R=i.opera.version,P="function"==typeof R?R():R;else if(O?Q=/rv\:([^\);]+)(\)|;)/:N?Q=/MSIE\s+([^\);]+)(\)|;)/:oa&&(Q=/WebKit\/(\S+)/),Q)var pa=Q.exec(ma()),P=pa?pa[1]:"";if(N){var S,qa=i.document;S=qa?qa.documentMode:void 0;if(S>parseFloat(P)){p=""+S;break a}}p=P}var T={},ra={};function sa(){return ra[9]||(ra[9]=N&&!!document.documentMode&&9<=document.documentMode)};!N||sa();if(O||N)if((!N||!sa())&&O)T["1.9.1"]||(T["1.9.1"]=0<=ca("1.9.1"));N&&(T["9"]||(T["9"]=0<=ca("9")));function ta(){}
function ua(a){"\ufeff"==a.charAt(0)&&(a=a.substr(1,a.length));new v;if("undefined"!=typeof DOMParser)a=(new DOMParser).parseFromString(a,"application/xml");else if("undefined"!=typeof ActiveXObject){var b=new ActiveXObject("MSXML2.DOMDocument");if(b){b.resolveExternals=h;b.validateOnParse=h;try{b.setProperty("ProhibitDTD",!0),b.setProperty("MaxXMLSize",2048),b.setProperty("MaxElementDepth",256)}catch(c){}}b.loadXML(a);a=b}else throw Error("Your browser does not support loading xml documents");return a}
function va(a,b){wa(a,b);r(b.childNodes,function(a){1==a.nodeType&&va(this,a)},a);xa(a,b)};function U(){this.j=[]}U.prototype.push=function(a){this.j.push(a)};U.prototype.pop=function(){return this.j.pop()};function V(){this.o=this.b=this.q=this.f=f}m(V,ta);l("sb.io.SbgnReader",V);V.prototype.v=function(a){this.f=new U;this.b=new E;this.o=[];this.q=[];va(this,ua(a).documentElement);r(this.q,function(a){var c=this.b.arc(a.getAttribute("id")),e=a.getAttribute("target"),a=a.getAttribute("source");c.source(a).target(e)},this);return this.b};V.prototype.parseText=V.prototype.v;
function wa(a,b){var c=b.tagName,c=c?c.toLocaleLowerCase():f,e=b.getAttribute("id"),d=a.f.j[a.f.j.length-1];if("glyph"==c)e=d instanceof B?d.t(e):a.b.createNode(e),c=b.getAttribute("class"),e.type(c),a.f.push(e),"compartment"==c&&u(a.o,e);else if("port"==c)(d instanceof B||d instanceof D)&&d.d(e);else if("arc"==c)c=a.b.p(e),e||b.setAttribute("id",c.id()),e=b.getAttribute("class"),c.type(e),a.f.push(c),u(a.q,b);else if("label"==c)d.label(b.getAttribute("text"));else if("bbox"==c){var g=new F(Number(b.getAttribute("x")),
Number(b.getAttribute("y")),Number(b.getAttribute("w")),Number(b.getAttribute("h")));"label"==b.parentNode.tagName.toLocaleLowerCase()?d.a("label.pos",g):(d.a("box",g),d instanceof B&&"compartment"!=d.type()&&r(a.o,function(a){a.a("box").contains(g)&&a.g(d)},a))}else"start"==c||"end"==c?d instanceof D&&d.a(c,new la(Number(b.getAttribute("x")),Number(b.getAttribute("y")))):"map"==c?((e=b.getAttribute("language"))&&a.b.lang(e),a.f.push(a.b)):"entity"==c&&d.a("entity",b.getAttribute("name"))}
function xa(a,b){var c=b.tagName;("glyph"==c||"arc"==c||"map"==c)&&a.f.pop()};function W(a,b,c){this.url=a;this.B=c;this.D=ya(this);c=document.createElement("script");c.setAttribute("type","text/javascript");var e="",b=b||{},d;for(d in b)b.hasOwnProperty(d)&&(e+=encodeURIComponent(d)+"="+encodeURIComponent(b[d])+"&");c.setAttribute("src",a+"?"+e+"callback=sb.io.Jsonp."+this.D);this.w=document.getElementsByTagName("head")[0].appendChild(c)}l("sb.io.Jsonp",W);W.call=function(a,b,c){new W(a,b,c)};
function ya(a){for(var b="",c=0;15>c;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));W[b]=function(c){a.B(c);delete W[b];a.w.parentNode.removeChild(a.w)};return b};var X={};l("sb.sbo.NodeTypeMapping",X);X["unspecified entity"]=285;X.compartment=290;X.macromolecule=245;X["macromolecule multimer"]=420;X["simple chemical"]=247;X["simple chemical multimer"]=421;X.complex=253;X["complex multimer"]=418;X.process=375;X["omitted process"]=379;X["uncertain process"]=396;X.annotation=110003;X.phenotype=358;X["nucleic acid feature"]=250;X["nucleic acid feature multimer"]=250;X.association=177;X.dissociation=180;X.entity=245;X.submap=395;X.terminal=110004;
X["perturbing agent"]=405;X["variable value"]=110001;X["implicit xor"]=-1;X.tag=110002;X.and=173;X.or=174;X.not=238;X.delay=225;X["source and sink"]=291;X.perturbation=405;X["biological activity"]=412;var Y={};l("sb.sbo.ArcTypeMapping",Y);Y.production=393;Y["equivalence arc"]=15;Y["logic arc"]=15;Y["necessary stimulation"]=461;Y.assignment=464;Y.interaction=342;Y["absolute inhibition"]=407;Y.modulation=168;Y.inhibition=169;Y["absolute stimulation"]=411;Y["unknown influence"]=168;
Y["positive influence"]=170;Y["negative influence"]=169;Y.stimulation=170;Y.catalysis=172;Y.consumption=15;Y.production=393;Y.catalysis=13;function za(){this.k=void 0}function Aa(a){var b=[];Z(new za,a,b);return b.join("")}
function Z(a,b,c){switch(typeof b){case "string":Ba(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==f){c.push("null");break}if("array"==aa(b)){var e=b.length;c.push("[");for(var d="",g=0;g<e;g++)c.push(d),d=b[g],Z(a,a.k?a.k.call(b,""+g,d):d,c),d=",";c.push("]");break}c.push("{");e="";for(g in b)Object.prototype.hasOwnProperty.call(b,g)&&(d=b[g],"function"!=typeof d&&(c.push(e),Ba(g,c),c.push(":"),
Z(a,a.k?a.k.call(b,g,d):d,c),e=","));c.push("}");break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var Ca={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Da=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Ba(a,b){b.push('"',a.replace(Da,function(a){if(a in Ca)return Ca[a];var b=a.charCodeAt(0),d="\\u";16>b?d+="000":256>b?d+="00":4096>b&&(d+="0");return Ca[a]=d+b.toString(16)}),'"')};function Ea(){}l("sb.io.JsbgnWriter",Ea);var $=[];$["entity relationship"]="ER";$["activity flow"]="AF";$["process description"]="PD";
Ea.prototype.write=function(a){var b={nodes:[],edges:[]};a.lang()&&(b.sbgnlang=$[a.lang()]);r(a.u(),function(a){if(!(a instanceof A)&&!fa(["unit of information","state variable"],a.type())){var e={};e.id=a.id();e.sbo=X[a.type()];e.is_abstract=h;var d={};e.data=d;a.n()&&(d.clone=!0);a.label()&&(d.label=a.label());var g=a.a("box");g&&(d.x=g.x,d.y=g.y,d.width=g.width,d.height=g.height);r(a.children(),function(a){if(!(a instanceof A))if(a.type()=="unit of information"){d.unitofinformation||(d.unitofinformation=
[]);u(d.unitofinformation,a.label()?a.label():"")}else if(a.type()!="state variable"){d.subnodes||(d.subnodes=[]);u(d.subnodes,a.id())}},this);u(b.nodes,e)}},this);r(a.l,function(a){var e={};e.id=a.id();e.sbo=0;e.source=a.source().id();e.target=a.target().id();e.data={};u(b.edges,e)},this);return Aa(b)};function Fa(a,b){var c;if("sbgn"==b)c=new V;else throw Error("Format "+b+" not supported");return c.v(a)}l("sb.io.read",Fa);l("sb.io.readUrl",function(a,b,c){new W("http://chemhack.com/jsonp/ba-simple-proxy.php",{url:a},function(a){200==a.status.http_code&&(a=Fa(a.contents,b),c(a))})});l("sb.io.write",function(a,b){var c;if("jsbgn"==b)c=new Ea;else throw Error("Format "+b+" not supported");return c.write(a)});})();
